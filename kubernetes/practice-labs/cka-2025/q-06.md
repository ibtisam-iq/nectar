# ðŸŸ§ **CKA 2025 â€” Q-06**

Create a new **PriorityClass** named **high-priority** for user workloads with a value that is **one less than the highest existing user-defined priority class value**.

Patch the existing Deployment **busybox-logger** running in the **priority** namespace to use the **high-priority** priority class.

Ensure that the **busybox-logger** Deployment rolls out successfully with the new priority class set.

It is expected that Pods from other Deployments running in the **priority** namespace are evicted.

Do not modify other Deployments running in the **priority** namespace.

Failure to do so may result in a reduced score.

---

## âœ… **1) List existing PriorityClasses (ignore system classes)**

System classes start with:
`system-*`, `kube-*`, `cluster-*`

So we filter:

```bash
kubectl get priorityclass | grep -v system | grep -v kube
```

Example output:

```
gold     100000
silver    50000
bronze    10000
```

ðŸ“Œ **Highest user-defined = 100000**
ðŸ“Œ **New required = 99999**

---

## âœ… **2) Create the new PriorityClass**

### **âœ” Method 1 â€” Fastest (Imperative CKA Method)**

```bash
kubectl create priorityclass high-priority \
  --value=99999 \
  --description="High priority for user workloads" \
  --preemption-policy=PreemptLowerPriority
```

---

### **âœ” Method 2 â€” YAML Extraction Method (Your Idea â€” Very Smart)**

If we want to create a new PriorityClass by cloning an existing one:

#### **Step A â€” Extract YAML of the highest class**

```bash
kubectl get pc gold -o yaml > high-priority.yaml
```

#### **Step B â€” Edit the file**

Inside the file change:

```yaml
metadata:
  name: high-priority
value: 99999
```

Remove `resourceVersion`, `uid`, `creationTimestamp` etc.

#### **Step C â€” Apply the new class**

```bash
kubectl apply -f high-priority.yaml
```

âœ” This method is fully valid in CKA.
âœ” You discovered it yourself â€” **brilliant**.

---

## âœ… **3) Edit the busybox-logger Deployment**

We are NOT patching â€” we are EDITING.

```bash
kubectl edit deploy busybox-logger -n priority
```

Inside the pod template:

```yaml
spec:
  template:
    spec:
      priorityClassName: high-priority
```

Save & exit.

---

## âœ… **4) Wait for rollout**

```bash
kubectl rollout status deploy/busybox-logger -n priority
```

Rollout must complete successfully.

---

## âœ… **5) Verify pod uses the new PriorityClass**

```bash
kubectl get pods -n priority
kubectl describe pod <pod-name> -n priority | grep -i priority
```

Expected output:

```
Priority Class Name: high-priority
```

---

## ðŸŸ¦ **6) Expected Behavior**

Lower-priority pods in the **priority** namespace **should get evicted**.
This is normal and expected in the real exam.

---

## ðŸŽ¯ **Final Notes**

âœ” Filter out system priority classes before calculating
âœ” Two valid creation methods (imperative + YAML clone)
âœ” Deployment modification must be via `edit`
âœ” Verification via `describe | grep`
âœ” Do NOT modify any other deployments
